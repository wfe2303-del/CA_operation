<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>í´ë˜ìŠ¤ì–´ë¼ìš´ë“œ Â· ë“œë¼ì´ë¸Œ í´ë” ëª¨ìŒ</title>
  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    :root{
      --blue:#2563eb;
      --red:#ef4444;
      --light:#f8fafc;
    }
    body{background:var(--light);}
    .nav-pill-active{
      border-color:var(--blue);
      background:rgba(37,99,235,0.06);
      color:#0f172a;
    }
    .nav-pill-active .dot{
      background:var(--blue);
    }
  </style>
</head>
<body class="text-slate-900">
  <div class="min-h-screen">
    <!-- ìƒë‹¨ í—¤ë” -->
    <header class="border-b border-slate-200 bg-white/80 backdrop-blur">
      <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between gap-4">
        <!-- ì™¼ìª½: ë¡œê³  + íƒ€ì´í‹€ -->
        <div class="flex items-center gap-3">
          <!-- ClassAround ë¡œê³  (kakao / syncì™€ ë™ì¼) -->
          <svg class="w-20 h-11" viewBox="0 0 90 50" role="img" aria-label="ClassAround">
            <rect width="90" height="50" rx="10" fill="white"/>
            <circle cx="66" cy="10" r="8" fill="#6b8bd6"/>
            <circle cx="80" cy="18" r="5" fill="#ef4444"/>
            <text x="8" y="24"
                  style="font-family:'Nunito','Arial Rounded MT','SF Pro Rounded','Quicksand','Pretendard','Noto Sans KR',sans-serif;
                         font-weight:900; letter-spacing:-0.2px; fill:#0f172a; font-size:18px;
                         paint-order:stroke fill; stroke:#0f172a; stroke-width:.9px;">
              Class
            </text>
            <text x="8" y="42"
                  style="font-family:'Nunito','Arial Rounded MT','SF Pro Rounded','Quicksand','Pretendard','Noto Sans KR',sans-serif;
                         font-weight:900; letter-spacing:-0.2px; fill:#0f172a; font-size:18px;
                         paint-order:stroke fill; stroke:#0f172a; stroke-width:.9px;">
              Around
            </text>
          </svg>
          <div>
            <div class="text-[11px] font-semibold text-slate-700">
            </div>
            <h1 class="text-base md:text-lg font-bold flex items-center gap-2">
              ë“œë¼ì´ë¸Œ í´ë” ëª¨ìŒ
              <span class="inline-flex items-center px-2 py-0.5 rounded-full text-[11px] font-semibold bg-red-50 text-red-500 border border-red-100">
                êµ¬ê¸€ ë“œë¼ì´ë¸Œ
              </span>
            </h1>
            <p class="text-xs md:text-sm text-slate-500">
            </p>
          </div>
        </div>

        <!-- ì˜¤ë¥¸ìª½: ì¸ì¦ ìƒíƒœ + ë²„íŠ¼ë“¤ -->
        <div class="flex items-center gap-2 md:gap-3 text-[11px]">
          <div class="hidden sm:flex items-center gap-1">
            <span id="authStateDot" class="inline-block w-2 h-2 rounded-full bg-slate-300"></span>
            <span id="authState" class="text-slate-500">
              Google ì¸ì¦ ìƒíƒœ í™•ì¸ ì¤‘
            </span>
          </div>
          <button id="btnAuthRefresh"
                  type="button"
                  class="px-2.5 py-1 rounded-full border border-sky-500 bg-white text-sky-600 hover:bg-sky-50 text-[11px]">
            Google ì¸ì¦
          </button>
          <a href="index.html"
             class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full border border-slate-200 text-xs font-medium bg-white hover:bg-slate-50">
            â† ëŒ€ì‹œë³´ë“œë¡œ
          </a>
        </div>
      </div>
    </header>

    <!-- ë©”ì¸ ë ˆì´ì•„ì›ƒ -->
    <main class="max-w-6xl mx-auto px-4 py-6">
      <div class="grid lg:grid-cols-[260px,minmax(0,1fr)] gap-5">
        <!-- ì™¼ìª½: í´ë” ë¦¬ìŠ¤íŠ¸ -->
        <aside class="bg-white rounded-2xl border border-slate-200 p-3 md:p-4 shadow-sm">
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-sm font-semibold flex items-center gap-1.5">
              ğŸ”— í´ë” ì„ íƒ
            </h2>
          </div>

          <div id="folderList" class="space-y-1.5 text-xs md:text-sm">
            <!-- JSì—ì„œ ë²„íŠ¼ ë Œë”ë§ -->
          </div>

          <div class="mt-4 p-2.5 rounded-xl bg-sky-50 border border-sky-100 text-[11px] leading-relaxed text-sky-800">
            â“˜í¬ê²Œ ë³´ê³  ì‹¶ìœ¼ë©´ <b>ã€Œìƒˆ íƒ­ì—ì„œ ì—´ê¸°ã€</b>
          </div>
        </aside>

        <!-- ì˜¤ë¥¸ìª½: ë·°ì–´ -->
        <section class="bg-white rounded-2xl border border-slate-200 shadow-sm flex flex-col min-h-[460px]">
          <div class="px-4 py-3 border-b border-slate-100 flex flex-wrap items-center justify-between gap-3">
            <div>
              <div class="text-xs uppercase tracking-wide text-slate-400 font-semibold">
              </div>
              <div class="flex items-center gap-2 mt-0.5">
                <h2 id="currentFolderName" class="text-sm md:text-base font-semibold">
                  í´ë”ë¥¼ ì„ íƒí•˜ì„¸ìš”
                </h2>
                <span id="currentFolderBadge"
                      class="hidden md:inline-flex items-center px-1.5 py-0.5 rounded-full text-[10px] font-medium border border-slate-200 text-slate-500">
                  -
                </span>
              </div>
            </div>

            <div class="flex items-center gap-2">
              <button id="btnOpenNewTab"
                      class="px-3 py-1.5 rounded-full text-[11px] font-semibold border border-blue-500 text-blue-600 bg-blue-50 hover:bg-blue-100 disabled:opacity-40 disabled:cursor-default"
                      disabled>
                ìƒˆ íƒ­ì—ì„œ ì—´ê¸°
              </button>
            </div>
          </div>

          <div class="flex-1 bg-slate-50 rounded-b-2xl overflow-hidden">
            <iframe
              id="driveFrame"
              src=""
              title="Google Drive folder viewer"
              class="w-full h-[420px] md:h-[520px] border-0 bg-slate-50">
            </iframe>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script>
    /* ========== Google ì¸ì¦ (í† í° í˜¸ì¶œ) ========== */
    const OAUTH_CLIENT_ID = "18228268359-iifm4ck3j9kqj74eh1p90tco1k2mbpi0.apps.googleusercontent.com";
    const OAUTH_SCOPES   = "https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/spreadsheets";

    let tokenClient = null;
    let accessToken = null;

    const $ = (sel) => document.querySelector(sel);

    function loadTokenFromSession(){
      const saved = sessionStorage.getItem("ca_gapi_token");
      if(saved){
        accessToken = saved;
      }
      updateAuthUI();
    }

    function initGoogleAuth(){
      if(!window.google?.accounts?.oauth2){
        alert("Google ë¡œê·¸ì¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        return;
      }
      if(!tokenClient){
        tokenClient = google.accounts.oauth2.initTokenClient({
          client_id: OAUTH_CLIENT_ID,
          scope: OAUTH_SCOPES,
          callback: (resp) => {
            if(resp?.access_token){
              accessToken = resp.access_token;
              sessionStorage.setItem("ca_gapi_token", accessToken);
              updateAuthUI();
            }else{
              alert("Google ì¸ì¦ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
            }
          }
        });
      }
      tokenClient.requestAccessToken({prompt:"consent"});
    }

    function updateAuthUI(){
      const dot   = $("#authStateDot");
      const label = $("#authState");
      if(!dot || !label) return;
      if(accessToken){
        dot.style.background = "#22c55e";
        label.textContent = "Google ì¸ì¦ ì™„ë£Œ (ì´ íƒ­ì—ì„œ í† í° ì‚¬ìš© ê°€ëŠ¥)";
      }else{
        dot.style.background = "#cbd5f5";
        label.textContent = "";
      }
    }

    /* ========== ë“œë¼ì´ë¸Œ í´ë” ê¸°ëŠ¥ ========== */

    // ===== í´ë” ì •ì˜ (í•˜ë“œì½”ë”©) =====
    const FOLDERS = [
      {
        id: "1LdDYVwxDrpqpPy2HYlSnrw2w7YKhsKWF",
        name: "í˜„ê¸ˆê²°ì œ êµ¬ê¸€í¼",
        desc: "í˜„ê¸ˆ/ê³„ì¢Œ ê²°ì œ ì‘ë‹µ ëª¨ìŒ",
        originalUrl: "https://drive.google.com/drive/folders/1LdDYVwxDrpqpPy2HYlSnrw2w7YKhsKWF?usp=drive_link"
      },
      {
        id: "1t33dy_UQCfsvoEQ9yOctIxvoT623i-j4",
        name: "ê°•ì‚¬ ê³µìœ ìš© ì‹œíŠ¸",
        desc: "ê°•ì‚¬ì§„ ê³µìœ  ì‹œíŠ¸ & ìë£Œ",
        originalUrl: "https://drive.google.com/drive/folders/1t33dy_UQCfsvoEQ9yOctIxvoT623i-j4?usp=drive_link"
      },
      {
        id: "1C1OsgYqZtxauLNN9l4mRHPgaIavrhmq-",
        name: "ë¬´ë£Œê°•ì˜ ì „ìì±… êµ¬ê¸€í¼",
        desc: "ë¬´ë£Œ ì „ìì±… ì‹ ì²­ ì‘ë‹µ",
        originalUrl: "https://drive.google.com/drive/u/0/folders/1C1OsgYqZtxauLNN9l4mRHPgaIavrhmq-"
      },
      {
        id: "1BU7ugKEeRXmG3PoRGJqKHlxuVtgT2_js",
        name: "ë¬´ë£Œê°•ì˜ ì‚¬ì „ ì§ˆë¬¸",
        desc: "ë¬´ë£Œê°•ì˜ Q&A / ì‚¬ì „ì§ˆë¬¸",
        originalUrl: "https://drive.google.com/drive/folders/1BU7ugKEeRXmG3PoRGJqKHlxuVtgT2_js?usp=drive_link"
      },
      {
        id: "1Ej6eIw0WwCn8NxtwW5A4vj8wo2xyKATC",
        name: "ë¼ì´ë¸Œ ìë£Œ",
        desc: "ë¼ì´ë¸Œ ë°©ì†¡ ìë£ŒÂ·PPT ëª¨ìŒ",
        originalUrl: "https://drive.google.com/drive/folders/1Ej6eIw0WwCn8NxtwW5A4vj8wo2xyKATC?usp=drive_link"
      }
    ];

    // Drive í´ë” embed URLë¡œ ë³€í™˜
    function makeEmbedUrl(id){
      // list ë·°ê°€ ë³´ê¸° í¸í•´ì„œ list ê¸°ì¤€
      return `https://drive.google.com/embeddedfolderview?id=${encodeURIComponent(id)}#list`;
    }

    const folderListEl       = document.getElementById("folderList");
    const driveFrameEl       = document.getElementById("driveFrame");
    const currentFolderName  = document.getElementById("currentFolderName");
    const currentFolderBadge = document.getElementById("currentFolderBadge");
    const btnOpenNewTab      = document.getElementById("btnOpenNewTab");

    let currentFolderId = null;

    function renderFolderButtons(){
      folderListEl.innerHTML = "";
      FOLDERS.forEach((f) => {
        const btn = document.createElement("button");
        btn.type  = "button";
        btn.dataset.folderId = f.id;
        btn.className =
          "w-full flex items-center justify-between gap-2 px-3 py-2 rounded-xl border border-slate-200 bg-white hover:border-blue-300 hover:bg-slate-50 text-left transition";

        btn.innerHTML = `
          <div class="flex items-center gap-2">
            <div class="dot w-1.5 h-1.5 rounded-full bg-slate-300"></div>
            <div>
              <div class="font-semibold text-xs md:text-[13px] truncate">${f.name}</div>
              <div class="text-[11px] text-slate-500 truncate">${f.desc}</div>
            </div>
          </div>
          <span class="text-[10px] font-semibold px-1.5 py-0.5 rounded-full border border-slate-200 text-slate-500">
            ì—´ê¸°
          </span>
        `;

        btn.addEventListener("click", () => selectFolder(f.id));
        folderListEl.appendChild(btn);
      });
    }

    function updateActiveButton(){
      const buttons = folderListEl.querySelectorAll("button[data-folder-id]");
      buttons.forEach(btn => {
        if(btn.dataset.folderId === currentFolderId){
          btn.classList.add("nav-pill-active");
        } else {
          btn.classList.remove("nav-pill-active");
        }
      });
    }

    function selectFolder(folderId){
      const folder = FOLDERS.find(f => f.id === folderId);
      if(!folder) return;

      currentFolderId = folderId;
      driveFrameEl.src = makeEmbedUrl(folder.id);

      currentFolderName.textContent = folder.name;
      currentFolderBadge.textContent = folder.desc || "";
      currentFolderBadge.classList.remove("hidden");

      btnOpenNewTab.disabled = false;
      btnOpenNewTab.onclick = () => {
        window.open(folder.originalUrl, "_blank", "noopener");
      };

      updateActiveButton();
    }

    // ì´ˆê¸° ì‹¤í–‰
    document.addEventListener("DOMContentLoaded", () => {
      // í† í° ë¡œë“œ & UI ë°˜ì˜
      loadTokenFromSession();

      // í´ë” ë²„íŠ¼ ë Œë”ë§
      renderFolderButtons();
      if(FOLDERS.length > 0){
        selectFolder(FOLDERS[0].id);
      }

      // Google ì¸ì¦ ë²„íŠ¼
      const btnAuth = document.getElementById("btnAuthRefresh");
      if(btnAuth){
        btnAuth.addEventListener("click", (e) => {
          e.preventDefault();
          initGoogleAuth();
        });
      }
    });
  </script>
</body>
</html>
